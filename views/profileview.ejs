<html>
<head>
    <title>Your Profile</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/profilestyle.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="https://kit.fontawesome.com/447fc5d1bf.js" crossorigin="anonymous"></script>

</head>
<body>
<script>
    (function(d, s, id){
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/messenger.Extensions.js";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'Messenger'));

    window.extAsyncInit = () => {
        MessengerExtensions.getSupportedFeatures(function success(result) {
            let features = result.supported_features;
            if (features.includes("context")) {
                MessengerExtensions.getContext('<APP-ID>',
                    function success(thread_context) {
                        document.getElementById("psid").value = thread_context.psid;
                    },
                    function error(err) {
                        console.log(err);
                    }
                );
            }
        }, function error(err) {
            console.log(err);
        });
        document.getElementById('submitButton').addEventListener('click', () => {
            MessengerExtensions.requestCloseBrowser(function success() {
                console.log("Webview closing");
            }, function error(err) {
                console.log(err);
            });
        });
    };
</script>
 <div class="jumbotron">
    <h3 class="greeting-header"> Your Profile</h3>
    <p class="greeting-info">
        Contained in the card below is all the information you have given so far, and is what others will see when they are paired up with you! Feel free to make any updates. 
    </p>
    <hr class="my-4">

    <div id="accordion">
        <div class="card">
          <div class="card-header" id="headingTwo">
            <h5 class="mb-0">
              <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                Wrong "Past Meetups" information?
              </button>
            </h5>
          </div>
          <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
            <div class="card-body">
                This is most likely because you reset your whole profile, which causes the bot to forget who you've met up with in the past. Click here to select people that you've already met up with (don't worry if you can't remember everyone!).
            </div>
          </div>
        </div>
    </div>
</div>
</div>


<div class="card-wrapper">
    <div class="card">
        <div class="card-container">
            <div class="header-center">
                <div class="card-container-header">
                    <div class="image">
                    <img class="card-img" src="https://graph.facebook.com/<%-data.user_id %>/picture?type=large&access_token=<%- access %>"/>
                    </div>
                    <div class="card-body">
                    <!-- <h5 class="card-title"><%- data.firstName %> <%-" " %> <%- data.lastName %></h5> -->

                    <h5 class="card-title">Stephanie Dixon</h5>
            
                    <% if (data.year == null) { %> 
                    <p class="card-text"><i class="fas fa-graduation-cap"></i> Incomplete </p>
                    <% } else if (data.year == 1) { %>
                    <p class="card-text"><i class="fas fa-graduation-cap"></i> Freshman</p>
                    <% } else if (data.year == 2) { %>
                    <p class="card-text"><i class="fas fa-graduation-cap"></i> Sophomore </p>
                    <% } else if (data.year == 3) { %>
                    <p class="card-text"><i class="fas fa-graduation-cap"></i> Junior </p>
                    <% } else if (data.year == 1) { %>
                    <p class="card-text"><i class="fas fa-graduation-cap"></i> Senior </p>
                    <% } %>
            
            
                    <% if (data.available) { %> 
                    <p class="card-text" id="avail"><i class="fas fa-user"></i> Available </p>
                    <% } else { %>
                    <p class="card-text" id="avail"><i class="fas fa-user-alt-slash"></i> Not Available </p>
                    <% } %>
                    </div>
                </div>
            </div>

            
            <div class="card-container-info">
                <div id="accordion">
                    <div class="card">
                      <div class="card-header" id="headingOne">
                        <h5 class="mb-0">
                          <button class="btn btn-link" id="button" data-toggle="collapse" data-target="#interestsOne" aria-expanded="false" aria-controls="interestsOne">
                            Interests <i class="far fa-surprise"></i>
                          </button>
                        </h5>
                      </div>
                      <div id="interestsOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
                        <div class="card-body">
                            <%- data.interests %>                  
                        </div>
                      </div>
                    </div>
                    <div class="card">
                      <div class="card-header" id="headingTwo">
                        <h5 class="mb-0">
                          <button class="btn btn-link collapsed" id="button" data-toggle="collapse" data-target="#funTwo" aria-expanded="false" aria-controls="funTwo">
                            Fun Fact <i class="far fa-laugh-squint"></i>
                          </button>
                        </h5>
                      </div>
                      <div id="funTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
                        <div class="card-body">
                            <%- data.fun_fact %>
                        </div>
                      </div>
                    </div>
                </div>
            </div>

        <div class="button-wrapper">
          <button type="button" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#exampleModal" data-whatever="@getbootstrap">Update Info</button>
          <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
              <div class="modal-content">
              <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">New message</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                  </button>
              </div>
              <div class="modal-body">
                  <form action="/profileupdate/<%- data.user_id %>" method="post">
                      <div class="form-group">
                          <label for="set-year">Year</label>
                          <select class="form-control" id="set-year">
  
                            <% if (data.year == null) { %>
                              <option selected="selected">Freshman</option>
                              <option>Sophomore</option>
                              <option>Junior</option>
                              <option>Senior</option>
                            <% } else if (data.year == 1) { %>
                              <option selected="selected">Freshman</option>
                              <option>Sophomore</option>
                              <option>Junior</option>
                              <option>Senior</option>
  
                            <% } else if (data.year == 2) { %>
                              <option>Freshman</option>
                              <option selected="selected">Sophomore</option>
                              <option>Junior</option>
                              <option>Senior</option>
  
                            <% } else if (data.year == 3) { %>
                              <option>Freshman</option>
                              <option>Sophomore</option>
                              <option selected="selected">Junior</option>
                              <option>Senior</option>
  
                            <% } else if (data.year == 4) { %>
                              <option>Freshman</option>
                              <option>Sophomore</option>
                              <option>Junior</option>
                              <option selected="selected">Senior</option>
                            <% } %>
                          </select>
                      </div>
                      <div class="form-group">
                          <label for="set-availability">Year</label>
                          <select class="form-control" id="set-availability">
  
                            <% if (data.available) { %>
                              <option selected="selected">Available</option>
                              <option>Not Available</option>
                            <% } else { %>
                              <option>Available</option>
                              <option selected="selected">Not Available</option>
                            <% } %>
                          </select>
                      </div>
                  </form>
              </div>
              <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  <button type="button" class="btn btn-primary">Send message</button>
              </div>
              </div>
          </div>
          </div>
          </div>
        </div>
    </div>
</div>
</body>
</html>
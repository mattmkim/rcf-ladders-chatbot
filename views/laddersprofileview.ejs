<html>
<head>
    <title>Profile</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/public/laddersprofilestyle.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="https://kit.fontawesome.com/447fc5d1bf.js" crossorigin="anonymous"></script>

</head>
<body>
<script>
    (function(d, s, id){
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/messenger.Extensions.js";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'Messenger'));

    window.extAsyncInit = () => {
        MessengerExtensions.getSupportedFeatures(function success(result) {
            let features = result.supported_features;
            if (features.includes("context")) {
                MessengerExtensions.getContext('<APP-ID>',
                    function success(thread_context) {
                        document.getElementById("psid").value = thread_context.psid;
                    },
                    function error(err) {
                        console.log(err);
                    }
                );
            }
        }, function error(err) {
            console.log(err);
        });
        // document.getElementById('submitButton').addEventListener('click', () => {
        //     MessengerExtensions.requestCloseBrowser(function success() {
        //         console.log("Webview closing");
        //     }, function error(err) {
        //         console.log(err);
        //     });
        // });

        
    };
</script>
 <div class="jumbotron">
    <h3 class="greeting-header"> <%- data.firstName%>'s Profile</h3>
    <p class="greeting-info">
        Meet <%- data.firstName%>! Have questions about <%- data.firstName%>'s interests or fun fact? Ask about them when you meet up! 
    </p>
</div>
</div>

<div class="card-wrapper">
    <div class="card">
        <div class="card-container">
            <div class="header-center">
                <div class="card-container-header">
                    <div class="image">
                    <img class="card-img" src="https://graph.facebook.com/<%-data.user_id %>/picture?type=large&access_token=<%- access %>"/>
                    </div>
                    <div class="card-body-profile">

                    <div class="center-title">
                      <h1 class="card-title"><%- data.firstName %> <%-" " %> <%- data.lastName %></h1>
                    </div>

                    <% if (data.bible_verse == null) { %>
                      <p class="card-verse-text-empty"></p>
                    <% } else { %>
                      <p class="card-verse-text"><%- data.bible_verse %></p>
                    <% } %>
                  
                    <div class="card-info">
                        <% if (data.year == null) { %> 
                         <p class="card-text"><i class="fas fa-graduation-cap"></i>: <span class="badge badge-secondary">Incomplete</span> </p>
                        <% } else if (data.year == 1) { %>
                        <p class="card-text"><i class="fas fa-graduation-cap"></i>: <span class="badge badge-secondary">Freshman</span> </p>
                        <% } else if (data.year == 2) { %>
                        <p class="card-text"><i class="fas fa-graduation-cap"></i>: <span class="badge badge-secondary">Sophomore</span> </p>
                        <% } else if (data.year == 3) { %>
                        <p class="card-text"><i class="fas fa-graduation-cap"></i>: <span class="badge badge-secondary">Junior</span> </p>
                        <% } else if (data.year == 4) { %>
                        <p class="card-text"><i class="fas fa-graduation-cap"></i>: <span class="badge badge-secondary">Senior</span> </p>
                        <% } %>
                    </div>
                      
                    </div>
                </div>
            </div>

            
            <div class="card-container-info">
                <div id="accordion">
                    <div class="card">
                      <div class="card-header" id="headingOne">
                        <h5 class="mb-0">
                          <button class="btn btn-link" id="button" data-toggle="collapse" data-target="#interestsOne" aria-expanded="false" aria-controls="interestsOne">
                            Interests <i class="far fa-surprise"></i>
                          </button>
                        </h5>
                      </div>
                      <div id="interestsOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
                        <div class="card-body">
                            <%- data.interests %>                  
                        </div>
                      </div>
                    </div>
                    <div class="card">
                      <div class="card-header" id="headingTwo">
                        <h5 class="mb-0">
                          <button class="btn btn-link collapsed" id="button" data-toggle="collapse" data-target="#funTwo" aria-expanded="false" aria-controls="funTwo">
                            Fun Fact <i class="far fa-laugh-squint"></i>
                          </button>
                        </h5>
                      </div>
                      <div id="funTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
                        <div class="card-body">
                            <%- data.fun_fact %>
                        </div>
                      </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>